


from flask import Flask, request, jsonify, render_template_string
import random

app = Flask(__name__)

# Sample matches with teams
matches = [
    {"name": "Team A vs Team B", "teams": ["Team A", "Team B"]},
    {"name": "Team C vs Team D", "teams": ["Team C", "Team D"]},
    {"name": "Team E vs Team F", "teams": ["Team E", "Team F"]},
]

# HTML + CSS + JS all in one
html_template = """
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini Betika</title>
<style>
body { font-family: Arial, sans-serif; background-color: #f7f7f7; margin:0; padding:0; }
header { background-color: #ff4500; color: white; padding: 15px; text-align: center; }
header div { margin-top: 5px; font-size: 16px; }
.bet-container { max-width: 800px; margin: 20px auto; background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0px 0px 10px rgba(0,0,0,0.1); }
.match { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; border-bottom: 1px solid #ddd; }
.match button { background-color: #ff4500; border: none; color: white; padding: 5px 10px; cursor: pointer; border-radius: 4px; }
</style>
</head>
<body>
<header>
    <h1>Mini Betika</h1>
    <div>Wallet: <span id="wallet">1000</span> Coins</div>
</header>
<div class="bet-container" id="matches"></div>
<script>
let wallet = 1000;

function updateWallet(amount) {
    wallet += amount;
    document.getElementById('wallet').innerText = wallet;
}

function loadMatches() {
    fetch('/matches')
        .then(res => res.json())
        .then(data => {
            const container = document.getElementById('matches');
            container.innerHTML = '';
            data.matches.forEach(match => {
                const div = document.createElement('div');
                div.className = 'match';
                div.innerHTML = `
                    <span>${match.name}</span>
                    ${match.teams.map(team => `<button onclick="placeBet('${match.name}','${team}')">Bet ${team}</button>`).join('')}
                `;
                container.appendChild(div);
            });
        });
}

function placeBet(matchName, team) {
    const betAmount = prompt('Enter bet amount:', '100');
    if (!betAmount || betAmount > wallet) {
        alert('Invalid bet amount!');
        return;
    }

    fetch('/bet', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ match: matchName, team: team, amount: parseInt(betAmount) })
    })
    .then(res => res.json())
    .then(data => {
        alert(data.message);
        updateWallet(data.walletChange);
    });
}

loadMatches();
</script>
</body>
</html>
"""

@app.route('/')
def index():
    return render_template_string(html_template)

@app.route('/matches')
def get_matches():
    return jsonify({"matches": matches})

@app.route('/bet', methods=['POST'])
def bet():
    data = request.get_json()
    match_name = data.get('match')
    team = data.get('team')
    amount = data.get('amount', 0)

    # Random win/lose simulation
    winner = random.choice([team, "other"])
    if winner == team:
        wallet_change = amount  # win amount
        message = f"Congrats! Your bet on {team} won! ðŸŽ‰ You gained {wallet_change} coins."
    else:
        wallet_change = -amount  # lose amount
        message = f"Sorry! Your bet on {team} lost. ðŸ˜¢ You lost {amount} coins."

    return jsonify({"message": message, "walletChange": wallet_change})

if __name__ == "__main__":
    app.run(debug=True)
